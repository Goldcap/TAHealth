/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dojo_widgets.search.WikiSearch"]){dojo._hasResource["dojo_widgets.search.WikiSearch"]=true;dojo.provide("dojo_widgets.search.WikiSearch");dojo.experimental("dojo_widgets.search.WikiSearch");dojo.require("dijit.Dialog");dojo.require("dijit._Widget");dojo.declare("dojo_widgets.search.WikiSearch",[dijit._Widget],{DojoSearchField:null,DojoSearchSubmit:null,SearchURL:null,initval:null,postCreate:function(){this.inherited(arguments);this.DojoSearchField=dojo.byId("DojoSearchField");this.DojoSearchSubmit=dojo.byId("DojoSearchSubmit");this.DojoSearchField.value=this.initval;dojo.connect(this.DojoSearchField,"onfocus",this,this.toggleSearchInputIn);dojo.connect(this.DojoSearchField,"onblur",this,this.toggleSearchInputOut);dojo.connect(this.DojoSearchSubmit,"onclick",this,this.submitSearch);this.SearchURL=location.pathname.split("/");this.update();this.init();},startup:function(){this.inherited(arguments);},submitSearch:function(e){dojo.stopEvent(e);this.doSearch();},doSearch:function(){if((this.DojoSearchField.value=="")||(this.DojoSearchField.value==this.initval)){return false;}url="/wiki/search";if(this.DojoSearchField.value!=this.initval){url=url+"/"+this.DojoSearchField.value;}document.location.href=url;return false;},init:function(){return true;},toggleSearchInputIn:function(){(this.DojoSearchField.value==this.initval)?this.DojoSearchField.value="":null;},toggleSearchInputOut:function(){(this.DojoSearchField.value=="")?this.DojoSearchField.value=this.initval:null;},update:function(){var _r=this.in_url("search");if(_r!=false){this.DojoSearchField.value=_r.replace("%20"," ");}},toggleDiv:function(_c){if((!dojo.style(_c,"display"))||(dojo.style(_c,"display")=="none")){var i=dojo.fadeIn({node:_c});dojo.connect(i,"beforeBegin",function(){dojo.style(_c,"opacity",0);dojo.style(_c,"display","block");});i.play();}else{var o=dojo.fadeOut({node:_c});dojo.connect(o,"onEnd",function(){dojo.style(_c,"opacity",0);dojo.style(_c,"display","none");});o.play();}},in_url:function(_f){var a=false;for(var i=0;i<this.SearchURL.length;i++){if(_f==this.SearchURL[i]){a=this.SearchURL[i+1];break;}}return a;},doKeyPress:function(e){switch(e.charOrCode){case dojo.keys.ENTER:dojo.stopEvent(e);this.submitSearch(e);break;}},showKeys:function(e){dojo.stopEvent(e);this.theDialog.show();dojo.connect(dojo.byId("keyword_suggest_submit"),"onclick",this,this.setSelectedKeyword);}});}