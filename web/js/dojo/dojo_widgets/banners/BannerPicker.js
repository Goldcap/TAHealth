/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dojo_widgets.banners.BannerPicker"]){dojo._hasResource["dojo_widgets.banners.BannerPicker"]=true;dojo.provide("dojo_widgets.banners.BannerPicker");dojo.experimental("dojo_widgets.banners.BannerPicker");dojo.require("dojo_widgets.layout.DynamicDialog");dojo.declare("dojo_widgets.banners.BannerPicker",[dojo_widgets.layout.DynamicDialog],{bannerId:156,bannerSrc:"/images/Banners/tattoojohnny/120x90findmytattoo.jpg",selectedType:"Homepage",isText:false,templatePath:"/js/dojo/dojo_widgets/banners/resources/BannerPicker.html",formProp:null,postCreate:function(){this.inherited(arguments);if(dojo.byId("AffiliateLinks")){this.formProp="AffiliateLinks";}if(dojo.byId("ResourceBanners")){this.formProp="ResourceBanners";}if(dojo.byId("affiliate_link_description").value!=""){dojo.byId("affiliate_link_text").value=dojo.byId("affiliate_link_description").value;dojo.byId("affiliate_link_preview").innerHTML=dojo.byId("affiliate_link_description").value;}dojo.connect(this.theDialog,"onLoad",this,"linkBanners");dojo.connect(dojo.byId("affiliate_link_destination"),"onchange",this,"doSelect");dojo.connect(dojo.byId("affiliate_link_keyword"),"onblur",this,"createHTML");dojo.connect(dojo.byId("AffiliateLinks"),"onsubmit",this,"checkHTML");dojo.connect(dojo.byId("affiliate_preview"),"onclick",this,"doPreview");this.theDialog.href=this.contentHref;},startup:function(){(document.forms[this.formProp].elements["fk_banner_id"].value>0)?(this.bannerId=dojo.byId("fk_banner_id").value):null;(document.forms[this.formProp].elements["fk_banner_url"].value.length>0)?(this.bannerSrc=dojo.byId("fk_banner_url").value):null;(document.forms[this.formProp].elements["fk_banner_id"].value<0)?(this.isText=true):null;this.selectedType=dojo.byId("affiliate_link_destination").value;this.inherited(arguments);if(this.isText){this.assignText();}if(dojo.byId("affiliate_link_text").innerHTML==""){this.doSelect();}},linkBanners:function(){var _1=this;dojo.query(".linkbanner").forEach(function(_2,i){dojo.connect(_2,"onclick",_1,"assignId");});},assignId:function(e){if(dojo.style("affiliate_text","display")!="none"){toggleDiv("affiliate_text");}dojo.byId("affiliate_link_description").value="";this.bannerId=e.target.id.replace("banner_","");this.bannerSrc=e.target.getAttribute("src");this.theDialog.hide();this.createHTML();},assignText:function(e){this.theDialog.hide();document.forms[this.formProp].elements["affiliate_link_description"].value="";toggleDiv("affiliate_text");if(dojo.style("banner_preview","display")=="none"){toggleDiv("banner_preview","null");}},applyText:function(e){this.bannerId=-1;document.forms[this.formProp].elements["fk_banner_id"].value=-1;this.bannerSrc="";this.createHTMLText();if(dojo.style("banner_preview","display")=="none"){toggleDiv("banner_preview","null");}},checkHTML:function(){dojo.style("banner_preview","opacity",0);dojo.style("banner_preview","display","block");if(document.forms[this.formProp].elements["fk_banner_id"].value<1){this.createHTMLText();}else{this.createHTML();}},createHTML:function(){var _7="<a href=\""+this.buildURL()+"\" border=\"0\" target=\"_new\"><img src=\""+this.bannerSrc+"\" border=\"0\" alt=\""+this.buildAlt()+"\"></a>";dojo.byId("affiliate_link_text").value=_7;dojo.byId("affiliate_link_preview").innerHTML=_7;dojo.byId("fk_banner_id").value=this.bannerId;dojo.byId("fk_banner_url").value=this.bannerSrc;},createHTMLText:function(){var _8="<a href=\""+this.buildURL()+"\" border=\"0\" target=\"_new\">"+dojo.byId("affiliate_link_description").value+"</a>";dojo.byId("affiliate_link_text").value=_8;dojo.byId("affiliate_link_preview").innerHTML=_8;},buildURL:function(){var _9=new Array();_9["Homepage"]="http://www.tattoojohnny.com/";_9["Most Popular"]="http://www.tattoojohnny.com/search";_9["Keyword Search"]="http://www.tattoojohnny.com/search/"+dojo.byId("affiliate_link_keyword").value;dojo.byId("affiliate_link_destination_url").value=_9[this.selectedType];var _a="http://www.tattoojohnny.com/tattoo_designs/tattoos";if(this.selectedType=="Keyword Search"){_a=_a+"/"+dojo.byId("affiliate_link_keyword").value;}return _a;},buildAlt:function(){var _b;var _c=new Array("Tattoos","Tattoo Designs","Tattoo Design Gallery","Downloadable Tattoos","Downloadable Tattoo Designs");var _d=Math.round((_c.length-1)*Math.random());switch(this.selectedType){case "Homepage":_b=_c[_d];break;case "Most Popular":_b=_c[_d];break;case "Keyword Search":_b=dojo.byId("affiliate_link_keyword").value+" "+_c[_d];break;}return _b;},doSelect:function(){this.selectedType=dojo.byId("affiliate_link_destination").value;if(((this.selectedType=="Keyword Search")&&(dojo.byId("affiliate_keyword").style.display!="block"))||((this.selectedType!="Keyword Search")&&(dojo.byId("affiliate_keyword").style.display=="block"))){toggleDiv("affiliate_keyword");(dojo.byId("vreqaffiliate_link_keyword").innerHTML=="TRUE")?dojo.byId("vreqaffiliate_link_keyword").innerHTML="FALSE":dojo.byId("vreqaffiliate_link_keyword").innerHTML="TRUE";}this.createHTML();},doPreview:function(e){dojo.stopEvent(e);var i=dojo.fadeIn({node:"banner_preview"});dojo.connect(i,"beforeBegin",function(){dojo.style("banner_preview","opacity",0);dojo.style("banner_preview","display","block");});i.play();}});}