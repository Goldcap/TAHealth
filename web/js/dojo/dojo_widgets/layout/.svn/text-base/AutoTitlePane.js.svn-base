/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dojo_widgets.layout.AutoTitlePane"]){dojo._hasResource["dojo_widgets.layout.AutoTitlePane"]=true;dojo.provide("dojo_widgets.layout.AutoTitlePane");dojo.require("dojo.fx");dojo.require("dijit._Templated");dojo.require("dojo_widgets.layout.AutoPane");dojo.declare("dojo_widgets.layout.AutoTitlePane",[dojo_widgets.layout.AutoPane,dijit._Templated],{boxheight:0,titleheight:0,title:"",open:true,duration:dijit.defaultDuration,baseClass:"dijitTitlePane",templateString:"<div dojoAttachPoint=\"baseNode\" class=\"${baseClass}\">\n\t<div dojoAttachEvent=\"onclick:toggle,onkeypress: _onTitleKey,onfocus:_handleFocus,onblur:_handleFocus\" tabindex=\"0\"\n\t\t\twaiRole=\"button\" class=\"dijitTitlePaneTitle\" dojoAttachPoint=\"titleBarNode,focusNode\">\n\t\t<span dojoAttachPoint=\"arrowNode\" class=\"dijitInline dijitArrowNode\"><span dojoAttachPoint=\"arrowNodeInner\" class=\"dijitArrowNodeInner\"></span></span\n\t\t><span dojoAttachPoint=\"titleNode\" class=\"dijitTitlePaneTextNode\"></span>\n\t</div>\n\t<div class=\"dijitTitlePaneContentOuter\" dojoAttachPoint=\"hideNode\">\n\t\t<div class=\"dijitReset\" dojoAttachPoint=\"wipeNode\">\n\t\t\t<div class=\"dijitTitlePaneContentInner\" dojoAttachPoint=\"containerNode\" waiRole=\"region\" tabindex=\"-1\">\n\t\t\t\t<!-- nested divs because wipeIn()/wipeOut() doesn't work right on node w/padding etc.  Put padding on inner div. -->\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n",attributeMap:dojo.mixin(dojo.clone(dijit.layout.ContentPane.prototype.attributeMap),{title:{node:"titleNode",type:"innerHTML"}}),constructor:function(_1){dojo.mixin(this,_1);},postCreate:function(){this.boxheight=dojo.marginBox(this.baseNode).h;this.titleheight=dojo.marginBox(this.focusNode).h;if(!this.open){this.hideNode.style.display=this.wipeNode.style.display="none";}this._setCss();dojo.setSelectable(this.titleNode,false);dijit.setWaiState(this.containerNode,"labelledby",this.titleNode.id);dijit.setWaiState(this.focusNode,"haspopup","true");var _2=this.hideNode,_3=this.wipeNode;this._wipeIn=dojo_widgets.layout.AutoTitlePane._wipeIn({node:this.wipeNode,duration:this.duration,height:{start:1,end:this.boxheight-this.titleheight},beforeBegin:function(){_2.style.display="";}});this._wipeOut=dojo_widgets.layout.AutoTitlePane._wipeOut({node:this.wipeNode,duration:this.duration,height:{start:this.boxheight-this.titleheight,end:1},onEnd:function(){_2.style.display="none";}});this.inherited(arguments);this._initSize();},_setContentAttr:function(_4){if(!this.open||this._wipeOut.status()=="playing"){this.inherited(arguments);}else{if(this._wipeIn.status()=="playing"){this._wipeIn.stop();}dojo.marginBox(this.wipeNode,{h:dojo.marginBox(this.wipeNode).h});this.inherited(arguments);this._wipeIn.play();}this._initSize();},toggle:function(){dojo.forEach([this._wipeIn,this._wipeOut],function(_5){if(_5.status()=="playing"){_5.stop();}});this[this.open?"_wipeOut":"_wipeIn"].play();this.open=!this.open;this._loadCheck();this._setCss();},_setCss:function(){var _6=["dijitClosed","dijitOpen"];var _7=this.open;var _8=this.titleBarNode||this.focusNode;dojo.removeClass(_8,_6[!_7+0]);_8.className+=" "+_6[_7+0];this.arrowNodeInner.innerHTML=this.open?"-":"+";},_onTitleKey:function(e){if(e.charOrCode==dojo.keys.ENTER||e.charOrCode==" "){this.toggle();}else{if(e.charOrCode==dojo.keys.DOWN_ARROW&&this.open){this.containerNode.focus();e.preventDefault();}}},_initSize:function(){if(this.open){dojo.marginBox(this.wipeNode,{h:this.boxheight-this.titleheight-2});}},_handleFocus:function(e){dojo[(e.type=="focus"?"addClass":"removeClass")](this.focusNode,this.baseClass+"Focused");},setTitle:function(_b){dojo.deprecated("dijit.TitlePane.setTitle() is deprecated.  Use attr('title', ...) instead.","","2.0");this.titleNode.innerHTML=_b;}});dojo_widgets.layout.AutoTitlePane._wipeIn=function(_c){_c.node=dojo.byId(_c.node);var _d=_c.node,s=_d.style,o;var _10=dojo.animateProperty(dojo.mixin({properties:{height:{start:function(){o=s.overflow;s.overflow="hidden";if(s.visibility=="hidden"||s.display=="none"){s.height=Math.max(_c.height.start,1)+"px";s.display="";s.visibility="";return 1;}else{return Math.max(_c.height.start,1);}},end:function(){return _c.height.end-2;}}}},_c));dojo.connect(_10,"onEnd",function(){s.height=_c.height.end-2;s.overflow=o;});return _10;};dojo_widgets.layout.AutoTitlePane._wipeOut=function(_11){var _12=_11.node=dojo.byId(_11.node);var s=_12.style;var o;var _15=dojo.animateProperty(dojo.mixin({properties:{height:{end:Math.max(_11.height.end,1)}}},_11));dojo.connect(_15,"beforeBegin",function(){o=s.overflow;s.overflow="hidden";s.display="";});dojo.connect(_15,"onEnd",function(){s.overflow=o;s.height="auto";s.display="none";});return _15;};}