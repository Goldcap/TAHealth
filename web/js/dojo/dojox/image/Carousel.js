/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dojox.image.Carousel"]){dojo._hasResource["dojox.image.Carousel"]=true;dojo.provide("dojox.image.Carousel");dojo.experimental("dojox.image.Carousel");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dojox.fx.scroll");dojo.require("dojo.fx.easing");dojo.require("dojo.fx");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.declare("dojox.image.Carousel",[dijit._Widget,dijit._Templated],{widgetID:null,imageStore:null,imageNodes:null,imageCount:0,request:null,size:150,ImageArray:null,InterFaceWidth:266,ViewingAreaHeight:110,ImageValignment:"middle",templatePath:"/js/dojo/dojox/image/resources/Carousel.html",header:"",viewLink:"",viewText:"",hitch:"null",init:true,currentImage:0,isMoving:false,postCreate:function(){this.inherited(arguments);this.widgetID=this.id;dojo.style(this.DojoCarouselViewingArea,"opacity","0");this.init();},init:function(){this.connect(this.DojoCarouselNavPrev,"onclick","_prev");this.connect(this.DojoCarouselNavNext,"onclick","_next");this.setDataStore();return true;},update:function(){this.hideNode(this.DojoCarouselLoader);this.setStyles();this.setIDs();this.attachEventhandlers();this.showNode(this.DojoCarouselViewingArea);},setDataStore:function(){this.imageNodes=new dojo.data.ItemFileReadStore({url:this.imageStore});this.imageNodes.fetch({onItem:this.setImage,onComplete:this.update,scope:this});},setImage:function(_1,_2){atitle=this.imageNodes.getValue(_1,"title");image=this.imageNodes.getValue(_1,"thumb");desc=this.imageNodes.getValue(_1,"desc");guid=this.imageNodes.getValue(_1,"guid");aclass=this.imageNodes.getValue(_1,"class");NewElement=document.createElement("span");NewElement.setAttribute("class","DojoCarouselSpan");var _3=(this.currentImage>1)?300:this.currentImage*150;NewElement.style.left=_3+"px";NewElement.innerHTML="<div guid=\""+guid+"\" class=\"thumbnailWrapper\" style=\"background-image: url("+image+");\" onClick=\""+this.hitch+"('"+guid+"')\" title=\""+desc+"\"><img src=\"/images/_clr.gif\" class=\""+aclass+"\" title=\""+desc+"\" alt=\""+desc+"\" /></div><div class=\"VideoTitle\">"+atitle+"</div>";this.DojoCarouselImageContainer.appendChild(NewElement);this.currentImage++;},setStyles:function(){dojo.style(this.DojoCarouselInterface,"width",this.InterFaceWidth+"px");dojo.style(this.DojoCarouselVerbiage,"width",this.InterFaceWidth-80+"px");dojo.style(this.DojoCarouselViewingArea,"zIndex",2);dojo.style(this.DojoCarouselVerbiage,"zIndex",5);dojo.style(this.DojoCarouselViewingArea,"left",0+"px");dojo.style(this.DojoCarouselVerbiage,"left",40+"px");dojo.style(this.DojoCarouselViewingArea,"top",0+"px");dojo.style(this.DojoCarouselVerbiage,"top",35+"px");dojo.style(this.DojoCarouselViewingArea,"height",this.ViewingAreaHeight+"px");dojo.style(this.DojoCarouselInterface,"height",this.ViewingAreaHeight+35+"px");dojo.style(this.DojoCarouselVerbiage,"textAlign","center");dojo.query("span div",this.DojoCarouselInterface).style("vertialAlign",this.ImageValignment);},setIDs:function(){var _4=this.widgetID;dojo.query("span.DojoCarouselSpan",this.DojoCarouselImageContainer).forEach(function(_5,i){dojo.attr(_5,"id",_4+"_"+i);});},attachEventhandlers:function(){var _7=this.widgetID;var _8=this.hitch;dojo.query("div.thumbnailWrapper",this.DojoCarouselImageContainer).forEach(function(_9,i){dojo.attr(_9,"id",_7+"Image_"+i);});},showNode:function(_b){dojo.fadeIn({node:_b,duration:500}).play();},hideNode:function(_c){dojo.fadeOut({node:_c,duration:200}).play();},_next:function(){if((this.currentImage<4)||(this.isMoving)){return;}this.isMoving=true;firstDiv=dojo.byId(this.widgetID+"_0");dupDiv=firstDiv.cloneNode(true);this.DojoCarouselImageContainer.appendChild(dupDiv);dojo.style(dupDiv,"left",300+"px");dojo.attr(dupDiv,"id","tmp");var o=dojo.fx.slideTo({node:this.widgetID+"_0",duration:500,left:-150,top:0});var t=dojo.fx.slideTo({node:this.widgetID+"_1",duration:500,left:0,top:0});var h=dojo.fx.slideTo({node:this.widgetID+"_2",duration:500,left:150,top:0});dojo.connect(o,"onEnd",this,function(){this.DojoCarouselImageContainer.removeChild(dojo.byId(this.widgetID+"_0"));this.update();});dojo.connect(h,"onEnd",this,function(){this.isMoving=false;});o.play();t.play();h.play();},_prev:function(){if((this.currentImage<4)||(this.isMoving)){return;}this.isMoving=true;lastDiv=dojo.byId(this.widgetID+"_"+(this.currentImage-1));dupDiv=lastDiv.cloneNode(true);this.DojoCarouselImageContainer.insertBefore(dupDiv,dojo.byId(this.widgetID+"_0"));this.update();dojo.style(dojo.byId(this.widgetID+"_0"),"left",-150+"px");var o=dojo.fx.slideTo({node:this.widgetID+"_0",duration:500,left:0,top:0});var t=dojo.fx.slideTo({node:this.widgetID+"_1",duration:500,left:150,top:0});var h=dojo.fx.slideTo({node:this.widgetID+"_2",duration:500,left:300,top:0});dojo.connect(o,"onEnd",this,function(){this.isMoving=false;});h.play();t.play();o.play();}});}